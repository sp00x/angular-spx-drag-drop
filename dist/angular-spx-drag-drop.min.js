/*! angular-spx-drag-drop v0.1.2 by Rune Bjerke | License: MIT | 2015-03-08 */
!function(){function a(){}function b(a){if(null==a)return a;var b=[];if("number"==typeof a.length)for(var c=0;a.length>c;c++)b.push(a[c]);return b}function c(a){var b={restrict:"A",link:i.bind(b,!1,a)};return b}function d(a){var b={restrict:"A",scope:{spxDrag:"=",spxDragBegin:"&",spxDragEnd:"&",spxDragClass:"@",spxDragEffect:"=",spxDragData:"="},link:i.bind(b,!0,a)};return b}function e(a){var b={restrict:"A",link:j.bind(b,!1,a)};return b}function f(a){var b={restrict:"A",scope:{spxDrop:"=",spxDropDrop:"&",spxDropOver:"&",spxDropClass:"=",spxDragEffect:"=",spxDropType:"=",spxDropRejectFiles:"=",spxDropEffectDefaultPriority:"=",spxDropEffectModifierKeys:"="},link:j.bind(b,!0,a)};return b}angular.module("spxDragDrop",[]).directive("spxDrag",["$parse",c]).directive("spxDrag2",["$parse",d]).directive("spxDrop",["$parse",e]).directive("spxDrop2",["$parse",f]);var g={copy:{copy:!0,move:!1,link:!1},link:{copy:!1,move:!1,link:!1},move:{copy:!1,move:!0,link:!1},copyLink:{copy:!0,move:!1,link:!0},copyMove:{copy:!0,move:!0,link:!1},linkMove:{copy:!1,move:!0,link:!1},none:{copy:!1,move:!1,link:!1},all:{copy:!0,move:!0,link:!0},uninitialized:{copy:void 0,move:void 0,link:void 0}},h={debug:console.debug?console.debug.bind(console):console.log.bind(console),log:console.log.bind(console),info:console.info.bind(console),warn:console.warn?console.warn.bind(console):console.error.bind(console),error:console.error.bind(console),group:console.group.bind(console),groupEnd:console.groupEnd.bind(console)};h={log:a,debug:a,info:a,warn:a,error:a,group:a,groupEnd:a};var i=function(a,b,c,d,e){function f(a,d){if("function"==d){if(null==a||""!=a){var e=b(a);return e.bind(this,c)}return void 0}return c.$eval(a)}function g(b){try{n=a?c.spxDragEffect:c.$eval(e.spxDragEffect);var g=a?c.spxDragData:f(e.spxDragData);if(k&&c.$apply(function(){var a=k({$event:b,$dragData:{data:g,effect:n}});null!=a&&"object"==typeof a?(a.data&&(g=a.data),a.effect&&(n=a.effect)):a!==!0&&(g=null)}),null!=g){b.dataTransfer.effectAllowed=n||b.dataTransfer.effectAllowed;for(var h in g){var i=g[h];if(h.match(/^application\/(.*?\+)?json$/i)||h.match(/^json\//i)){var j=angular.toJson(i);b.dataTransfer.setData(h,j)}else{var l;l=null==i?"":"string"==typeof i||"string"==typeof i?i:"object"==typeof i?angular.toJson(i):i.toString(),b.dataTransfer.setData(h,l)}}m=a?c.spxDragClass:c.$eval(e.spxDragClass),m&&d.addClass(m)}b.stopPropagation()}finally{}}function h(a){m&&d.removeClass(m),m=null,l&&c.$apply(function(){l({$event:a})})}var i=d[0],j=null,k=null,l=null,m=null,n=null;a?(j=c.spxDrag!==!1,k=c.spxDragBegin,l=c.spxDragEnd):(j=f(e.spxDrag)!==!1,k=f(e.spxDragBegin,"function"),l=f(e.spxDragEnd,"function")),i.draggable=j,j&&(i.addEventListener("dragstart",g),i.addEventListener("dragend",h),c.$on("$destroy",function(){i.removeEventListener("dragstart",g),i.removeEventListener("dragend",h)}))},j=function(a,c,d,e,f){function h(a,b){if("function"==b){if(null==a||""!=a){var e=c(a);return e.bind(this,d)}return void 0}return d.$eval(a)}function i(a){if(a.dataTransfer&&"none"==a.dataTransfer.dropEffect){var b=g[y],c=g[a.dataTransfer.effectAllowed],d=(a.ctrlKey?"c":"")+(a.altKey?"a":"")+(a.shiftKey?"s":""),e=w[d];if(null!=e&&b[e]===!0&&c[e]===!0&&(a.dataTransfer.dropEffect=e),"none"==a.dataTransfer.dropEffect&&""==d)for(var f=0;v.length>f;f++)if(c[v[f]]){a.dataTransfer.dropEffect=v[f];break}}return a.dataTransfer.dropEffect}function j(a){s&&e.removeClass(s),i(a),a.preventDefault(),a.stopPropagation(),p&&d.$apply(function(){var b={effect:a.dataTransfer.dropEffect,items:{}};A.forEach(function(a){try{b.items[a]="Files"==a?c.dataTransfer.files:a.match(/^application\/(.*?\+)?json$/i)||a.match(/^json\//i)?JSON.parse(c.dataTransfer.getData(a)):c.dataTransfer.getData(a)}catch(c){}});p({$event:a,$dropData:b})})}function k(a){return x?(i(a),s&&!z&&e.addClass(s),a.preventDefault(),!1):void 0}function l(c){v=a?d.spxDropEffectDefaultPriority:h(f.spxDropEffectDefaultPriority),w=a?d.spxDropEffectModifierKeys:h(f.spxDropEffectModifierKeys),v=v||["move","copy","link"],w=w||{c:"copy",a:"link",s:"move"};var g=c.dataTransfer;g.files&&g.files.length>0;var j={};g.types&&b(g.types).forEach(function(a){j[a]=!0}),t=a?d.spxDropEffect:h(f.spxDropEffect),u=a?d.spxDropRejectFiles:h(f.spxDropRejectFiles),A=[];var k=[];return r=a?d.spxDropType:h(f.spxDropType),"string"==typeof r?r.split(",").forEach(function(a){a=a.trim(),a.length>0&&k.push(a)}):r instanceof Array&&(k=k.concat(r)),x=!1,k.forEach(function(a){j[a]&&(x=!0)}),q&&d.$apply(function(){var a=q({$event:c,$dropData:{acceptedTypes:k,effect:t,className:s,accept:x}});null!=a&&"object"==typeof a?(a.acceptedTypes&&(k=a.acceptedTypes),a.effect&&(t=a.effect),a.className&&(s=a.className),x=!!a.accept,k.forEach(function(a){j[a]&&(x=!0)})):a===!0?x=!0:(x=!1,k=[])}),z=!1,!x&&u&&j.Files&&(x=!0,z=!0),x?(i(c),A=[],k.forEach(function(a){j[a]&&A.push(a)}),s=null,z?c.effectAllowed=y="none":(c.effectAllowed=y=t,s=a?d.spxDropClass:h(f.spxDropClass),s&&e.addClass(s)),c.preventDefault(),!1):void 0}function m(){s&&e.removeClass(s)}var n=e[0],o=a?d.spxDrop:h(f.spxDrop),p=a?d.spxDropDrop:h(f.spxDropDrop,"function"),q=a?d.spxDropOver:h(f.spxDropOver,"function"),r=null,s=null,t=null,u=null,v=[],w={};if(o!==!1){var x=!1,y="none",z=!1,A=[];n.addEventListener("drop",j),n.addEventListener("dragenter",l),n.addEventListener("dragover",k),n.addEventListener("dragleave",m),d.$on("$destroy",function(){n.removeEventListener("drop",j),n.removeEventListener("dragenter",l),n.removeEventListener("dragover",k),n.removeEventListener("dragleave",m)})}}}();
//# sourceMappingURL=angular-spx-drag-drop.min.js.map